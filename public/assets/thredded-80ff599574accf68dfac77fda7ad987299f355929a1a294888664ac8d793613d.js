function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}!function(e,t){"object"==typeof module&&module.exports?(module.exports=t(e),module.exports["default"]=module.exports):e.timeago=t(e)}("undefined"!=typeof window?window:this,function(){function n(e){return e instanceof Date?e:isNaN(e)?/^\d+$/.test(e)?new Date(a(e)):(e=(e||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([\+\-]\d\d)\:?(\d\d)/," $1$2"),new Date(e)):new Date(a(e))}function a(e){return parseInt(e)}function u(e,t,n){t=h[t]?t:h[n]?n:"en";for(var r=0,o=e<0?1:0,i=e=Math.abs(e);e>=p[r]&&r<m;r++)e/=p[r];return(0===(r*=2)?9:1)<(e=a(e))&&(r+=1),h[t](e,r,i)[o].replace("%s",e)}function s(e,t){return((t=t?n(t):new Date)-n(e))/1e3}function c(e){for(var t=1,n=0,r=Math.abs(e);e>=p[n]&&n<m;n++)e/=p[n],t*=p[n];return r=(r%=t)?t-r:t,Math.ceil(r)}function o(e){return r(e,"data-timeago")||r(e,"datetime")}function r(e,t){return e.getAttribute?e.getAttribute(t):e.attr?e.attr(t):void 0}function l(e,t){return e.setAttribute?e.setAttribute(v,t):e.attr?e.attr(v,t):void 0}function i(e,t){this.nowDate=e,this.defaultLocale=t||"en"}function e(e,t){return new i(e,t)}var d="second_minute_hour_day_week_month_year".split("_"),f="\u79d2_\u5206\u949f_\u5c0f\u65f6_\u5929_\u5468_\u6708_\u5e74".split("_"),h={en:function(e,t){if(0===t)return["just now","right now"];var n=d[parseInt(t/2)];return 1<e&&(n+="s"),[e+" "+n+" ago","in "+e+" "+n]},zh_CN:function(e,t){if(0===t)return["\u521a\u521a","\u7247\u523b\u540e"];var n=f[parseInt(t/2)];return[e+n+"\u524d",e+n+"\u540e"]}},p=[60,60,24,7,365/7/12,12],m=6,v="data-tid",y={};return i.prototype.doRender=function(e,t,n){var r,o=s(t,this.nowDate),i=this;e.innerHTML=u(o,n,this.defaultLocale),y[r=setTimeout(function(){i.doRender(e,t,n),delete y[r]},Math.min(1e3*c(o),2147483647))]=0,l(e,r)},i.prototype.format=function(e,t){return u(s(e,this.nowDate),t,this.defaultLocale)},i.prototype.render=function(e,t){e.length===undefined&&(e=[e]);for(var n=0,r=e.length;n<r;n++)this.doRender(e[n],o(e[n]),t)},i.prototype.setLocale=function(e){this.defaultLocale=e},e.register=function(e,t){h[e]=t},e.cancel=function(e){var t;if(e)(t=r(e,v))&&(clearTimeout(t),delete y[t]);else{for(t in y)clearTimeout(t);y={}}},e}),function(){var e=this;(function(){(function(){this.Rails={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote]:not([disabled]), a[data-disable-with], a[data-disable]",buttonClickSelector:{selector:"button[data-remote]:not([form]), button[data-confirm]:not([form])",exclude:"form button"},inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not([type]), input[type=submit][form], input[type=image][form], button[type=submit][form], button[form]:not([type])",formDisableSelector:"input[data-disable-with]:enabled, button[data-disable-with]:enabled, textarea[data-disable-with]:enabled, input[data-disable]:enabled, button[data-disable]:enabled, textarea[data-disable]:enabled",formEnableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled, input[data-disable]:disabled, button[data-disable]:disabled, textarea[data-disable]:disabled",fileInputSelector:"input[name][type=file]:not([disabled])",linkDisableSelector:"a[data-disable-with], a[data-disable]",buttonDisableSelector:"button[data-remote][data-disable-with], button[data-remote][data-disable]"}}).call(this)}).call(e);var b=e.Rails;(function(){(function(){var r,n;n=Element.prototype.matches||Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector,b.matches=function(e,t){return null!=t.exclude?n.call(e,t.selector)&&!n.call(e,t.exclude):n.call(e,t)},r="_ujsData",b.getData=function(e,t){var n;return null!=(n=e[r])?n[t]:void 0},b.setData=function(e,t,n){return null==e[r]&&(e[r]={}),e[r][t]=n},b.$=function(e){return Array.prototype.slice.call(document.querySelectorAll(e))}}).call(this),function(){var n,r,o;n=b.$,o=b.csrfToken=function(){var e;return(e=document.querySelector("meta[name=csrf-token]"))&&e.content},r=b.csrfParam=function(){var e;return(e=document.querySelector("meta[name=csrf-param]"))&&e.content},b.CSRFProtection=function(e){var t;if(null!=(t=o()))return e.setRequestHeader("X-CSRF-Token",t)},b.refreshCSRFTokens=function(){var e,t;if(t=o(),e=r(),null!=t&&null!=e)return n('form input[name="'+e+'"]').forEach(function(e){return e.value=t})}}.call(this),function(){var o,t,i;i=b.matches,"function"!=typeof(o=window.CustomEvent)&&((o=function(e,t){var n;return(n=document.createEvent("CustomEvent")).initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}).prototype=window.Event.prototype),t=b.fire=function(e,t,n){var r;return r=new o(t,{bubbles:!0,cancelable:!0,detail:n}),e.dispatchEvent(r),!r.defaultPrevented},b.stopEverything=function(e){return t(e.target,"ujs:everythingStopped"),e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation()},b.delegate=function(e,n,t,r){return e.addEventListener(t,function(e){var t;for(t=e.target;t instanceof Element&&!i(t,n);)t=t.parentNode;if(t instanceof Element&&!1===r.call(t,e))return e.preventDefault(),e.stopPropagation()})}}.call(this),function(){var t,r,e,o,i;r=b.CSRFProtection,b.fire,t={"*":"*/*",text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript",script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},b.ajax=function(t){var n;return t=o(t),n=e(t,function(){var e;return e=i(n.response,n.getResponseHeader("Content-Type")),2===Math.floor(n.status/100)?"function"==typeof t.success&&t.success(e,n.statusText,n):"function"==typeof t.error&&t.error(e,n.statusText,n),"function"==typeof t.complete?t.complete(n,n.statusText):void 0}),!("function"!=typeof t.beforeSend||!t.beforeSend(n,t))&&(n.readyState===XMLHttpRequest.OPENED?n.send(t.data):void 0)},o=function(e){return e.url=e.url||location.href,e.type=e.type.toUpperCase(),"GET"===e.type&&e.data&&(e.url.indexOf("?")<0?e.url+="?"+e.data:e.url+="&"+e.data),null==t[e.dataType]&&(e.dataType="*"),e.accept=t[e.dataType],"*"!==e.dataType&&(e.accept+=", */*; q=0.01"),e},e=function(e,t){var n;return(n=new XMLHttpRequest).open(e.type,e.url,!0),n.setRequestHeader("Accept",e.accept),"string"==typeof e.data&&n.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),e.crossDomain||n.setRequestHeader("X-Requested-With","XMLHttpRequest"),r(n),n.withCredentials=!!e.withCredentials,n.onreadystatechange=function(){if(n.readyState===XMLHttpRequest.DONE)return t(n)},n},i=function(e,t){var n,r;if("string"==typeof e&&"string"==typeof t)if(t.match(/\bjson\b/))try{e=JSON.parse(e)}catch(o){}else if(t.match(/\b(?:java|ecma)script\b/))(r=document.createElement("script")).text=e,document.head.appendChild(r).parentNode.removeChild(r);else if(t.match(/\b(xml|html|svg)\b/)){n=new DOMParser,t=t.replace(/;.+/,"");try{e=n.parseFromString(e,t)}catch(o){}}return e},b.href=function(e){return e.href},b.isCrossDomain=function(e){var t,n;(t=document.createElement("a")).href=location.href,n=document.createElement("a");try{return n.href=e,!((!n.protocol||":"===n.protocol)&&!n.host||t.protocol+"//"+t.host==n.protocol+"//"+n.host)}catch(r){return r,!0}}}.call(this),function(){var o,i;o=b.matches,i=function(e){return Array.prototype.slice.call(e)},b.serializeElement=function(e,t){var n,r;return n=[e],o(e,"form")&&(n=i(e.elements)),r=[],n.forEach(function(t){if(t.name&&!t.disabled)return o(t,"select")?i(t.options).forEach(function(e){if(e.selected)return r.push({name:t.name,value:e.value})}):t.checked||-1===["radio","checkbox","submit"].indexOf(t.type)?r.push({name:t.name,value:t.value}):void 0}),t&&r.push(t),r.map(function(e){return null!=e.name?encodeURIComponent(e.name)+"="+encodeURIComponent(e.value):e}).join("&")},b.formElements=function(e,t){return o(e,"form")?i(e.elements).filter(function(e){return o(e,t)}):i(e.querySelectorAll(t))}}.call(this),function(){var t,i,n;i=b.fire,n=b.stopEverything,b.handleConfirm=function(e){if(!t(this))return n(e)},t=function(e){var t,n,r;if(!(r=e.getAttribute("data-confirm")))return!0;if(t=!1,i(e,"confirm")){try{t=confirm(r)}catch(o){}n=i(e,"confirm:complete",[t])}return t&&n}}.call(this),function(){var n,r,o,i,a,u,t,s,c,l,d;c=b.matches,s=b.getData,l=b.setData,d=b.stopEverything,t=b.formElements,b.handleDisabledElement=function(e){if(this.disabled)return d(e)},b.enableElement=function(e){var t;return t=e instanceof Event?e.target:e,c(t,b.linkDisableSelector)?u(t):c(t,b.buttonDisableSelector)||c(t,b.formEnableSelector)?i(t):c(t,b.formSubmitSelector)?a(t):void 0},b.disableElement=function(e){var t;return t=e instanceof Event?e.target:e,c(t,b.linkDisableSelector)?o(t):c(t,b.buttonDisableSelector)||c(t,b.formDisableSelector)?n(t):c(t,b.formSubmitSelector)?r(t):void 0},o=function(e){var t;return null!=(t=e.getAttribute("data-disable-with"))&&(l(e,"ujs:enable-with",e.innerHTML),e.innerHTML=t),e.addEventListener("click",d),l(e,"ujs:disabled",!0)},u=function(e){var t;return null!=(t=s(e,"ujs:enable-with"))&&(e.innerHTML=t,l(e,"ujs:enable-with",null)),e.removeEventListener("click",d),l(e,"ujs:disabled",null)},r=function(e){return t(e,b.formDisableSelector).forEach(n)},n=function(e){var t;return null!=(t=e.getAttribute("data-disable-with"))&&(c(e,"button")?(l(e,"ujs:enable-with",e.innerHTML),e.innerHTML=t):(l(e,"ujs:enable-with",e.value),e.value=t)),e.disabled=!0,l(e,"ujs:disabled",!0)},a=function(e){return t(e,b.formEnableSelector).forEach(i)},i=function(e){var t;return null!=(t=s(e,"ujs:enable-with"))&&(c(e,"button")?e.innerHTML=t:e.value=t,l(e,"ujs:enable-with",null)),e.disabled=!1,l(e,"ujs:disabled",null)}}.call(this),function(){var s;s=b.stopEverything,b.handleMethod=function(e){var t,n,r,o,i,a,u;if(u=(a=this).getAttribute("data-method"))return i=b.href(a),n=b.csrfToken(),t=b.csrfParam(),r=document.createElement("form"),o="<input name='_method' value='"+u+"' type='hidden' />",null==t||null==n||b.isCrossDomain(i)||(o+="<input name='"+t+"' value='"+n+"' type='hidden' />"),o+='<input type="submit" />',r.method="post",r.action=i,r.target=a.target,r.innerHTML=o,r.style.display="none",document.body.appendChild(r),r.querySelector('[type="submit"]').click(),s(e)}}.call(this),function(){var s,c,l,d,f,h,p,m,v,y=[].slice;h=b.matches,l=b.getData,m=b.setData,c=b.fire,v=b.stopEverything,s=b.ajax,d=b.isCrossDomain,p=b.serializeElement,f=function(e){var t;return null!=(t=e.getAttribute("data-remote"))&&"false"!==t},b.handleRemote=function(e){var t,n,r,o,i,a,u;return!f(o=this)||(c(o,"ajax:before")?(u=o.getAttribute("data-with-credentials"),r=o.getAttribute("data-type")||"script",h(o,b.formSubmitSelector)?(t=l(o,"ujs:submit-button"),i=l(o,"ujs:submit-button-formmethod")||o.method,a=l(o,"ujs:submit-button-formaction")||o.getAttribute("action")||location.href,"GET"===i.toUpperCase()&&(a=a.replace(/\?.*$/,"")),"multipart/form-data"===o.enctype?(n=new FormData(o),null!=t&&n.append(t.name,t.value)):n=p(o,t),m(o,"ujs:submit-button",null),m(o,"ujs:submit-button-formmethod",null),m(o,"ujs:submit-button-formaction",null)):h(o,b.buttonClickSelector)||h(o,b.inputChangeSelector)?(i=o.getAttribute("data-method"),a=o.getAttribute("data-url"),n=p(o,o.getAttribute("data-params"))):(i=o.getAttribute("data-method"),a=b.href(o),n=o.getAttribute("data-params")),s({type:i||"GET",url:a,data:n,dataType:r,beforeSend:function(e,t){return c(o,"ajax:beforeSend",[e,t])?c(o,"ajax:send",[e]):(c(o,"ajax:stopped"),!1)},success:function(){var e;return e=1<=arguments.length?y.call(arguments,0):[],c(o,"ajax:success",e)},error:function(){var e;return e=1<=arguments.length?y.call(arguments,0):[],c(o,"ajax:error",e)},complete:function(){var e;return e=1<=arguments.length?y.call(arguments,0):[],c(o,"ajax:complete",e)},crossDomain:d(a),withCredentials:null!=u&&"false"!==u}),v(e)):(c(o,"ajax:stopped"),!1))},b.formSubmitButtonClick=function(){var e,t;if(t=(e=this).form)return e.name&&m(t,"ujs:submit-button",{name:e.name,value:e.value}),m(t,"ujs:formnovalidate-button",e.formNoValidate),m(t,"ujs:submit-button-formaction",e.getAttribute("formaction")),m(t,"ujs:submit-button-formmethod",e.getAttribute("formmethod"))},b.handleMetaClick=function(e){var t,n,r;if(r=((n=this).getAttribute("data-method")||"GET").toUpperCase(),t=n.getAttribute("data-params"),(e.metaKey||e.ctrlKey)&&"GET"===r&&!t)return e.stopImmediatePropagation()}}.call(this),function(){var e,r,t,n,o,i,a,u,s,c,l,d,f,h;i=b.fire,t=b.delegate,u=b.getData,e=b.$,h=b.refreshCSRFTokens,r=b.CSRFProtection,o=b.enableElement,n=b.disableElement,c=b.handleDisabledElement,s=b.handleConfirm,f=b.handleRemote,a=b.formSubmitButtonClick,l=b.handleMetaClick,d=b.handleMethod,"undefined"==typeof jQuery||null===jQuery||null==jQuery.ajax||jQuery.rails||(jQuery.rails=b,jQuery.ajaxPrefilter(function(e,t,n){if(!e.crossDomain)return r(n)})),b.start=function(){if(window._rails_loaded)throw new Error("rails-ujs has already been loaded!");return window.addEventListener("pageshow",function(){return e(b.formEnableSelector).forEach(function(e){if(u(e,"ujs:disabled"))return o(e)}),e(b.linkDisableSelector).forEach(function(e){if(u(e,"ujs:disabled"))return o(e)})}),t(document,b.linkDisableSelector,"ajax:complete",o),t(document,b.linkDisableSelector,"ajax:stopped",o),t(document,b.buttonDisableSelector,"ajax:complete",o),t(document,b.buttonDisableSelector,"ajax:stopped",o),t(document,b.linkClickSelector,"click",c),t(document,b.linkClickSelector,"click",s),t(document,b.linkClickSelector,"click",l),t(document,b.linkClickSelector,"click",n),t(document,b.linkClickSelector,"click",f),t(document,b.linkClickSelector,"click",d),t(document,b.buttonClickSelector,"click",c),t(document,b.buttonClickSelector,"click",s),t(document,b.buttonClickSelector,"click",n),t(document,b.buttonClickSelector,"click",f),t(document,b.inputChangeSelector,"change",c),t(document,b.inputChangeSelector,"change",s),t(document,b.inputChangeSelector,"change",f),t(document,b.formSubmitSelector,"submit",c),t(document,b.formSubmitSelector,"submit",s),t(document,b.formSubmitSelector,"submit",f),t(document,b.formSubmitSelector,"submit",function(e){return setTimeout(function(){return n(e)},13)}),t(document,b.formSubmitSelector,"ajax:send",n),t(document,b.formSubmitSelector,"ajax:complete",o),t(document,b.formInputClickSelector,"click",c),t(document,b.formInputClickSelector,"click",s),t(document,b.formInputClickSelector,"click",a),document.addEventListener("DOMContentLoaded",h),window._rails_loaded=!0},window.Rails===b&&i(document,"rails:attachBindings")&&b.start()}.call(this)}).call(this),"object"==typeof module&&module.exports?module.exports=b:"function"==typeof define&&define.amd&&define(b)}.call(this),function(e,t){if("function"==typeof define&&define.amd)define(["exports","module"],t);else if("undefined"!=typeof exports&&"undefined"!=typeof module)t(exports,module);else{var n={exports:{}};t(n.exports,n),e.autosize=n.exports}}(this,function(e,t){"use strict";function n(o){function e(){var e=window.getComputedStyle(o,null);"vertical"===e.resize?o.style.resize="none":"both"===e.resize&&(o.style.resize="horizontal"),s="content-box"===e.boxSizing?-(parseFloat(e.paddingTop)+parseFloat(e.paddingBottom)):parseFloat(e.borderTopWidth)+parseFloat(e.borderBottomWidth),isNaN(s)&&(s=0),n()}function i(e){var t=o.style.width;o.style.width="0px",o.offsetWidth,o.style.width=t,o.style.overflowY=e}function a(e){for(var t=[];e&&e.parentNode&&e.parentNode instanceof Element;)e.parentNode.scrollTop&&t.push({node:e.parentNode,scrollTop:e.parentNode.scrollTop}),e=e.parentNode;return t}function u(){var e=o.style.height,t=a(o),n=document.documentElement&&document.documentElement.scrollTop;o.style.height="";var r=o.scrollHeight+s;return 0===o.scrollHeight?void(o.style.height=e):(o.style.height=r+"px",c=o.clientWidth,t.forEach(function(e){e.node.scrollTop=e.scrollTop}),void(n&&(document.documentElement.scrollTop=n)))}function n(){u();var e=Math.round(parseFloat(o.style.height)),t=window.getComputedStyle(o,null),n="content-box"===t.boxSizing?Math.round(parseFloat(t.height)):o.offsetHeight;if(n!==e?"hidden"===t.overflowY&&(i("scroll"),u(),n="content-box"===t.boxSizing?Math.round(parseFloat(window.getComputedStyle(o,null).height)):o.offsetHeight):"hidden"!==t.overflowY&&(i("hidden"),u(),n="content-box"===t.boxSizing?Math.round(parseFloat(window.getComputedStyle(o,null).height)):o.offsetHeight),l!==n){l=n;var r=h("autosize:resized");try{o.dispatchEvent(r)}catch(o){}}}if(o&&o.nodeName&&"TEXTAREA"===o.nodeName&&!f.has(o)){var s=null,c=o.clientWidth,l=null,r=function(){o.clientWidth!==c&&n()},d=function(t){window.removeEventListener("resize",r,!1),o.removeEventListener("input",n,!1),o.removeEventListener("keyup",n,!1),o.removeEventListener("autosize:destroy",d,!1),o.removeEventListener("autosize:update",n,!1),Object.keys(t).forEach(function(e){o.style[e]=t[e]}),f["delete"](o)}.bind(o,{height:o.style.height,resize:o.style.resize,overflowY:o.style.overflowY,overflowX:o.style.overflowX,wordWrap:o.style.wordWrap});o.addEventListener("autosize:destroy",d,!1),"onpropertychange"in o&&"oninput"in o&&o.addEventListener("keyup",n,!1),window.addEventListener("resize",r,!1),o.addEventListener("input",n,!1),o.addEventListener("autosize:update",n,!1),o.style.overflowX="hidden",o.style.wordWrap="break-word",f.set(o,{destroy:d,update:n}),e()}}function r(e){var t=f.get(e);t&&t.destroy()}function o(e){var t=f.get(e);t&&t.update()}var i,a,f="function"==typeof Map?new Map:(i=[],a=[],{has:function(e){return-1<i.indexOf(e)},get:function(e){return a[i.indexOf(e)]},set:function(e,t){-1===i.indexOf(e)&&(i.push(e),a.push(t))},"delete":function(e){var t=i.indexOf(e);-1<t&&(i.splice(t,1),a.splice(t,1))}}),h=function(e){return new Event(e,{bubbles:!0})};try{new Event("test")}catch(e){h=function(e){var t=document.createEvent("Event");return t.initEvent(e,!0,!1),t}}var u=null;"undefined"==typeof window||"function"!=typeof window.getComputedStyle?((u=function(e){return e}).destroy=function(e){return e},u.update=function(e){return e}):((u=function(e,t){return e&&Array.prototype.forEach.call(e.length?e:[e],function(e){return n(e,t)}),e}).destroy=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],r),e},u.update=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],o),e}),t.exports=u}),function(n){function r(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,r),t.l=!0,t.exports}var o={};r.m=n,r.c=o,r.i=function(e){return e},r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=11)}([function(e,t,n){"use strict";function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),r=n(1),a=(r&&r.__esModule,function(){function r(e,t,n){o(this,r),this.data=e,this.term=t,this.strategy=n}return i(r,[{key:"replace",value:function(e,t){var n=this.strategy.replace(this.data);if(null!==n){Array.isArray(n)&&(t=n[1]+t,n=n[0]);var r=this.strategy.matchText(e);if(r)return n=n.replace(/\$&/g,r[0]).replace(/\$(\d+)/g,function(e,t){return r[parseInt(t,10)]}),[[e.slice(0,r.index),n,e.slice(r.index+r[0].length)].join(""),t]}}},{key:"render",value:function(){return this.strategy.template(this.data,this.term)}}]),r}());t["default"]=a},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e){return e}Object.defineProperty(t,"__esModule",{value:!0});var i,a=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),u=n(12),s=(i=u)&&i.__esModule?i:{"default":i},c=function(){function t(e){r(this,t),this.props=e,this.cache=e.cache?{}:null}return a(t,[{key:"destroy",value:function(){return this.cache=null,this}},{key:"buildQuery",value:function(e){if("function"==typeof this.props.context){var t=this.props.context(e);if("string"==typeof t)e=t;else if(!t)return null}var n=this.matchText(e);return n?new s["default"](this,n[this.index],n):null}},{key:"search",value:function(e,t,n){this.cache?this.searchWithCache(e,t,n):this.props.search(e,t,n)}},{key:"replace",value:function(e){return this.props.replace(e)}},{key:"searchWithCache",value:function(t,n,e){var r=this;this.cache&&this.cache[t]?n(this.cache[t]):this.props.search(t,function(e){r.cache&&(r.cache[t]=e),n(e)},e)}},{key:"matchText",value:function(e){return"function"==typeof this.match?this.match(e):e.match(this.match)}},{key:"match",get:function(){return this.props.match}},{key:"index",get:function(){return"number"==typeof this.props.index?this.props.index:2}},{key:"template",get:function(){return this.props.template||o}}]),t}();t["default"]=c},function(e){"use strict";function c(){}function i(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function t(){this._events=new c,this._eventsCount=0}var r=Object.prototype.hasOwnProperty,h="~";Object.create&&(c.prototype=Object.create(null),(new c).__proto__||(h=!1)),t.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)r.call(e,t)&&n.push(h?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},t.prototype.listeners=function(e,t){var n=h?h+e:e,r=this._events[n];if(t)return!!r;if(!r)return[];if(r.fn)return[r.fn];for(var o=0,i=r.length,a=new Array(i);o<i;o++)a[o]=r[o].fn;return a},t.prototype.emit=function(e,t,n,r,o,i){var a=h?h+e:e;if(!this._events[a])return!1;var u,s,c=this._events[a],l=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),l){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,n),!0;case 4:return c.fn.call(c.context,t,n,r),!0;case 5:return c.fn.call(c.context,t,n,r,o),!0;case 6:return c.fn.call(c.context,t,n,r,o,i),!0}for(s=1,u=new Array(l-1);s<l;s++)u[s-1]=arguments[s];c.fn.apply(c.context,u)}else{var d,f=c.length;for(s=0;s<f;s++)switch(c[s].once&&this.removeListener(e,c[s].fn,void 0,!0),l){case 1:c[s].fn.call(c[s].context);break;case 2:c[s].fn.call(c[s].context,t);break;case 3:c[s].fn.call(c[s].context,t,n);break;case 4:c[s].fn.call(c[s].context,t,n,r);break;default:if(!u)for(d=1,u=new Array(l-1);d<l;d++)u[d-1]=arguments[d];c[s].fn.apply(c[s].context,u)}}return!0},t.prototype.on=function(e,t,n){var r=new i(t,n||this),o=h?h+e:e;return this._events[o]?this._events[o].fn?this._events[o]=[this._events[o],r]:this._events[o].push(r):(this._events[o]=r,this._eventsCount++),this},t.prototype.once=function(e,t,n){var r=new i(t,n||this,!0),o=h?h+e:e;return this._events[o]?this._events[o].fn?this._events[o]=[this._events[o],r]:this._events[o].push(r):(this._events[o]=r,this._eventsCount++),this},t.prototype.removeListener=function(e,t,n,r){var o=h?h+e:e;if(!this._events[o])return this;if(!t)return 0==--this._eventsCount?this._events=new c:delete this._events[o],this;var i=this._events[o];if(i.fn)i.fn!==t||r&&!i.once||n&&i.context!==n||(0==--this._eventsCount?this._events=new c:delete this._events[o]);else{for(var a=0,u=[],s=i.length;a<s;a++)(i[a].fn!==t||r&&!i[a].once||n&&i[a].context!==n)&&u.push(i[a]);u.length?this._events[o]=1===u.length?u[0]:u:0==--this._eventsCount?this._events=new c:delete this._events[o]}return this},t.prototype.removeAllListeners=function(e){var t;return e?(t=h?h+e:e,this._events[t]&&(0==--this._eventsCount?this._events=new c:delete this._events[t])):(this._events=new c,this._eventsCount=0),this},t.prototype.off=t.prototype.removeListener,t.prototype.addListener=t.prototype.on,t.prototype.setMaxListeners=function(){return this},t.prefixed=h,t.EventEmitter=t,e.exports=t},function(e,t){"use strict";function n(e){var t=e.getBoundingClientRect(),n=e.ownerDocument,r=n.defaultView,o=n.documentElement,i={top:t.top+r.pageYOffset,left:t.left+r.pageXOffset};return o&&(i.top-=o.clientTop,i.left-=o.clientLeft),i}function i(e){return o<=e&&e<=a}function r(e){var t=window.getComputedStyle(e);if(i(t.lineHeight.charCodeAt(0)))return i(t.lineHeight.charCodeAt(t.lineHeight.length-1))?parseFloat(t.lineHeight)*parseFloat(t.fontSize):parseFloat(t.lineHeight);var n=document.body;if(!n)return 0;var r=document.createElement(e.nodeName);r.innerHTML="&nbsp;",r.style.fontSize=t.fontSize,r.style.fontFamily=t.fontFamily,n.appendChild(r);var o=r.offsetHeight;return n.removeChild(r),o}Object.defineProperty(t,"__esModule",{value:!0}),t.calculateElementOffset=n,t.getLineHeightPx=r;var o=(t.createCustomEvent="function"==typeof window.CustomEvent?function(e,t){return new document.defaultView.CustomEvent(e,{cancelable:t&&t.cancelable||!1,detail:t&&t.detail||void 0})}:function(e,t){var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,t&&t.cancelable||!1,t&&t.detail||void 0),n},"0".charCodeAt(0)),a="9".charCodeAt(0)},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),s=r(n(2)),c=r(n(10)),l=(r(n(0)),n(3)),d="dropdown-menu textcomplete-dropdown",f=function(){function r(e){o(this,r);var t=i(this,(r.__proto__||Object.getPrototypeOf(r)).call(this));t.shown=!1,t.items=[],t.footer=e.footer,t.header=e.header,t.maxCount=e.maxCount||10,t.el.className=e.className||d,t.rotate=!e.hasOwnProperty("rotate")||e.rotate,t.placement=e.placement;var n=e.style;return n&&Object.keys(n).forEach(function(e){t.el.style[e]=n[e]}),t}return a(r,s["default"]),u(r,null,[{key:"createElement",value:function(){var e=document.createElement("ul"),t=e.style;t.display="none",t.position="absolute",t.zIndex="10000";var n=document.body;return n&&n.appendChild(e),e}}]),u(r,[{key:"destroy",value:function(){var e=this.el.parentNode;return e&&e.removeChild(this.el),this.clear()._el=null,this}},{key:"render",value:function(e,t){var n=(0,l.createCustomEvent)("render",{cancelable:!0});if(this.emit("render",n),n.defaultPrevented)return this;var r=e.map(function(e){return e.data}),o=e.slice(0,this.maxCount||e.length).map(function(e){return new c["default"](e)});return this.clear().setStrategyId(e[0]).renderEdge(r,"header").append(o).renderEdge(r,"footer").setOffset(t).show(),this.emit("rendered",(0,l.createCustomEvent)("rendered")),this}},{key:"deactivate",value:function(){return this.hide().clear()}},{key:"select",value:function(e){var t={searchResult:e.searchResult},n=(0,l.createCustomEvent)("select",{cancelable:!0,detail:t});return this.emit("select",n),n.defaultPrevented||(this.deactivate(),this.emit("selected",(0,l.createCustomEvent)("selected",{detail:t}))),this}},{key:"up",value:function(e){return this.shown?this.moveActiveItem("prev",e):this}},{key:"down",value:function(e){return this.shown?this.moveActiveItem("next",e):this}},{key:"getActiveItem",value:function(){return this.items.find(function(e){return e.active})}},{key:"append",value:function(e){var t=this,n=document.createDocumentFragment();return e.forEach(function(e){t.items.push(e),e.appended(t),n.appendChild(e.el)}),this.el.appendChild(n),this}},{key:"setOffset",value:function(e){if(e.left?this.el.style.left=e.left+"px":e.right&&(this.el.style.right=e.right+"px"),this.isPlacementTop()){var t=document.documentElement;t&&(this.el.style.bottom=t.clientHeight-e.top+e.lineHeight+"px")}else this.el.style.top=e.top+"px";return this}},{key:"show",value:function(){if(!this.shown){var e=(0,l.createCustomEvent)("show",{cancelable:!0});if(this.emit("show",e),e.defaultPrevented)return this;this.el.style.display="block",this.shown=!0,this.emit("shown",(0,l.createCustomEvent)("shown"))}return this}},{key:"hide",value:function(){if(this.shown){var e=(0,l.createCustomEvent)("hide",{cancelable:!0});if(this.emit("hide",e),e.defaultPrevented)return this;this.el.style.display="none",this.shown=!1,this.emit("hidden",(0,l.createCustomEvent)("hidden"))}return this}},{key:"clear",value:function(){return this.el.innerHTML="",this.items.forEach(function(e){return e.destroy()}),this.items=[],this}},{key:"moveActiveItem",value:function(e,t){var n=this.getActiveItem(),r=void 0;return(r=n?n[e]:"next"===e?this.items[0]:this.items[this.items.length-1])&&(r.activate(),t.preventDefault()),this}},{key:"setStrategyId",value:function(e){var t=e&&e.strategy.props.id;return t?this.el.setAttribute("data-strategy",t):this.el.removeAttribute("data-strategy"),this}},{key:"renderEdge",value:function(e,t){var n=("header"===t?this.header:this.footer)||"",r="function"==typeof n?n(e):n,o=document.createElement("li");return o.classList.add("textcomplete-"+t),o.innerHTML=r,this.el.appendChild(o),this}},{key:"isPlacementTop",value:function(){return"top"===this.placement}},{key:"el",get:function(){return this._el||(this._el=r.createElement()),this._el}}]),r}();t["default"]=f},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),s=r(n(2)),c=n(3),l=(r(n(0)),function(){function e(){return o(this,e),i(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return a(e,s["default"]),u(e,[{key:"destroy",value:function(){return this}},{key:"applySearchResult",value:function(){throw new Error("Not implemented.")}},{key:"getCursorOffset",value:function(){throw new Error("Not implemented.")}},{key:"getBeforeCursor",value:function(){throw new Error("Not implemented.")}},{key:"getAfterCursor",value:function(){throw new Error("Not implemented.")}},{key:"emitMoveEvent",value:function(e){var t=(0,c.createCustomEvent)("move",{cancelable:!0,detail:{code:e}});return this.emit("move",t),t}},{key:"emitEnterEvent",value:function(){var e=(0,c.createCustomEvent)("enter",{cancelable:!0});return this.emit("enter",e),e}},{key:"emitChangeEvent",value:function(){var e=(0,c.createCustomEvent)("change",{detail:{beforeCursor:this.getBeforeCursor()}});return this.emit("change",e),e}},{key:"emitEscEvent",value:function(){var e=(0,c.createCustomEvent)("esc",{cancelable:!0});return this.emit("esc",e),e}},{key:"getCode",value:function(e){
return 8===e.keyCode?"BS":9===e.keyCode?"ENTER":13===e.keyCode?"ENTER":16===e.keyCode?"META":17===e.keyCode?"META":18===e.keyCode?"META":27===e.keyCode?"ESC":38===e.keyCode?"UP":40===e.keyCode?"DOWN":78===e.keyCode&&e.ctrlKey?"DOWN":80===e.keyCode&&e.ctrlKey?"UP":91===e.keyCode?"META":93===e.keyCode?"META":"OTHER"}}]),e}());t["default"]=l},function(t,n,r){"use strict";function o(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),c=function e(t,n,r){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,n);if(void 0===o){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,r)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(r):void 0},l=o(r(14)),d=o(r(5)),f=r(3),h=(o(r(0)),r(13)),p=["onInput","onKeydown"],m=function(){function n(e){i(this,n);var t=a(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return t.el=e,p.forEach(function(e){t[e]=t[e].bind(t)}),t.startListening(),t}return u(n,d["default"]),s(n,[{key:"destroy",value:function(){return c(n.prototype.__proto__||Object.getPrototypeOf(n.prototype),"destroy",this).call(this),this.stopListening(),this.el=null,this}},{key:"applySearchResult",value:function(e){var t=e.replace(this.getBeforeCursor(),this.getAfterCursor());this.el.focus(),Array.isArray(t)&&((0,l["default"])(this.el,t[0],t[1]),this.el.dispatchEvent(new Event("input")))}},{key:"getCursorOffset",value:function(){var e=(0,f.calculateElementOffset)(this.el),t=this.getElScroll(),n=this.getCursorPosition(),r=(0,f.getLineHeightPx)(this.el),o=e.top-t.top+n.top+r,i=e.left-t.left+n.left;return"rtl"!==this.el.dir?{top:o,left:i,lineHeight:r}:{top:o,right:document.documentElement?document.documentElement.clientWidth-i:0,lineHeight:r}}},{key:"getBeforeCursor",value:function(){return this.el.value.substring(0,this.el.selectionEnd)}},{key:"getAfterCursor",value:function(){return this.el.value.substring(this.el.selectionEnd)}},{key:"getElScroll",value:function(){return{top:this.el.scrollTop,left:this.el.scrollLeft}}},{key:"getCursorPosition",value:function(){return h(this.el,this.el.selectionEnd)}},{key:"onInput",value:function(){this.emitChangeEvent()}},{key:"onKeydown",value:function(e){var t=this.getCode(e),n=void 0;"UP"===t||"DOWN"===t?n=this.emitMoveEvent(t):"ENTER"===t?n=this.emitEnterEvent():"ESC"===t&&(n=this.emitEscEvent()),n&&n.defaultPrevented&&e.preventDefault()}},{key:"startListening",value:function(){this.el.addEventListener("input",this.onInput),this.el.addEventListener("keydown",this.onKeydown)}},{key:"stopListening",value:function(){this.el.removeEventListener("input",this.onInput),this.el.removeEventListener("keydown",this.onKeydown)}}]),n}();n["default"]=m},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),c=r(n(9)),l=r((r(n(5)),n(4))),d=r(n(1)),f=r((r(n(0)),n(2))),h=["handleChange","handleEnter","handleEsc","handleHit","handleMove","handleSelect"],o=function(){function o(e,t){var n=1<arguments.length&&void 0!==t?t:{};i(this,o);var r=a(this,(o.__proto__||Object.getPrototypeOf(o)).call(this));return r.completer=new c["default"],r.isQueryInFlight=!1,r.nextPendingQuery=null,r.dropdown=new l["default"](n.dropdown||{}),r.editor=e,r.options=n,h.forEach(function(e){r[e]=r[e].bind(r)}),r.startListening(),r}return u(o,f["default"]),s(o,[{key:"destroy",value:function(e){var t=!(0<arguments.length&&void 0!==e)||e;return this.completer.destroy(),this.dropdown.destroy(),t&&this.editor.destroy(),this.stopListening(),this}},{key:"register",value:function(e){var t=this;return e.forEach(function(e){t.completer.registerStrategy(new d["default"](e))}),this}},{key:"trigger",value:function(e){return this.isQueryInFlight?this.nextPendingQuery=e:(this.isQueryInFlight=!0,this.nextPendingQuery=null,this.completer.run(e)),this}},{key:"handleHit",value:function(e){var t=e.searchResults;t.length?this.dropdown.render(t,this.editor.getCursorOffset()):this.dropdown.deactivate(),this.isQueryInFlight=!1,null!==this.nextPendingQuery&&this.trigger(this.nextPendingQuery)}},{key:"handleMove",value:function(e){"UP"===e.detail.code?this.dropdown.up(e):this.dropdown.down(e)}},{key:"handleEnter",value:function(e){var t=this.dropdown.getActiveItem();t&&(this.dropdown.select(t),e.preventDefault())}},{key:"handleEsc",value:function(e){this.dropdown.shown&&(this.dropdown.deactivate(),e.preventDefault())}},{key:"handleChange",value:function(e){this.trigger(e.detail.beforeCursor)}},{key:"handleSelect",value:function(e){this.emit("select",e),e.defaultPrevented||this.editor.applySearchResult(e.detail.searchResult)}},{key:"startListening",value:function(){var t=this;this.editor.on("move",this.handleMove).on("enter",this.handleEnter).on("esc",this.handleEsc).on("change",this.handleChange),this.dropdown.on("select",this.handleSelect),["show","shown","render","rendered","selected","hidden","hide"].forEach(function(e){t.dropdown.on(e,function(){return t.emit(e)})}),this.completer.on("hit",this.handleHit)}},{key:"stopListening",value:function(){this.completer.removeAllListeners(),this.dropdown.removeAllListeners(),this.editor.removeListener("move",this.handleMove).removeListener("enter",this.handleEnter).removeListener("esc",this.handleEsc).removeListener("change",this.handleChange)}}]),o}();t["default"]=o},function(e){var t;t=function(){return this}();try{t=t||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(t=window)}e.exports=t},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),s=r(n(2)),c=(r((r(n(1)),n(0))),["handleQueryResult"]),l=function(){function e(){o(this,e);var t=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.strategies=[],c.forEach(function(e){t[e]=t[e].bind(t)}),t}return a(e,s["default"]),u(e,[{key:"destroy",value:function(){return this.strategies.forEach(function(e){return e.destroy()}),this}},{key:"registerStrategy",value:function(e){return this.strategies.push(e),this}},{key:"run",value:function(e){var t=this.extractQuery(e);t?t.execute(this.handleQueryResult):this.handleQueryResult([])}},{key:"extractQuery",value:function(e){for(var t=0;t<this.strategies.length;t++){var n=this.strategies[t].buildQuery(e);if(n)return n}return null}},{key:"handleQueryResult",value:function(e){this.emit("hit",{searchResults:e})}}]),e}();t["default"]=l},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0}),t.CLASS_NAME=void 0;var i=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),a=(r((r(n(4)),n(0))),t.CLASS_NAME="textcomplete-item"),u=a+" active",s=["onClick","onMouseover"],c=function(){function n(e){var t=this;o(this,n),this.searchResult=e,this.active=!1,s.forEach(function(e){t[e]=t[e].bind(t)})}return i(n,[{key:"destroy",value:function(){this.el.removeEventListener("mousedown",this.onClick,!1),this.el.removeEventListener("mouseover",this.onMouseover,!1),this.el.removeEventListener("touchstart",this.onClick,!1),this._el=null}},{key:"appended",value:function(e){this.dropdown=e,this.siblings=e.items,this.index=this.siblings.length-1}},{key:"activate",value:function(){if(!this.active){var e=this.dropdown.getActiveItem();e&&e.deactivate(),this.active=!0,this.el.className=u}return this}},{key:"deactivate",value:function(){return this.active&&(this.active=!1,this.el.className=a),this}},{key:"onClick",value:function(e){e.preventDefault(),this.dropdown.select(this)}},{key:"onMouseover",value:function(){this.activate()}},{key:"el",get:function(){if(this._el)return this._el;var e=document.createElement("li");e.className=this.active?u:a;var t=document.createElement("a");return t.innerHTML=this.searchResult.render(),e.appendChild(t),(this._el=e).addEventListener("mousedown",this.onClick),e.addEventListener("mouseover",this.onMouseover),e.addEventListener("touchstart",this.onClick),e}},{key:"next",get:function(){var e=void 0;if(this.index===this.siblings.length-1){if(!this.dropdown.rotate)return null;e=0}else e=this.index+1;return this.siblings[e]}},{key:"prev",get:function(){var e=void 0;if(0===this.index){if(!this.dropdown.rotate)return null;e=this.siblings.length-1}else e=this.index-1;return this.siblings[e]}}]),n}();t["default"]=c},function(e,t,i){"use strict";(function(e){function t(e){return e&&e.__esModule?e:{"default":e}}var n=t(i(7)),r=t(i(6)),o=void 0;(o=e.Textcomplete&&e.Textcomplete.editors?e.Textcomplete.editors:{}).Textarea=r["default"],e.Textcomplete=n["default"],e.Textcomplete.editors=o}).call(t,i(8))},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}(),a=r(n(0)),u=(r(n(1)),function(){function r(e,t,n){o(this,r),this.strategy=e,this.term=t,this.match=n}return i(r,[{key:"execute",value:function(t){var n=this;this.strategy.search(this.term,function(e){t(e.map(function(e){return new a["default"](e,n.term,n.strategy)}))},this.match)}}]),r}());t["default"]=u},function(t){!function(){function e(e,t,n){if(!d)throw new Error("textarea-caret-position#getCaretCoordinates should only be called in a browser");var r=n&&n.debug||!1;if(r){var o=document.querySelector("#input-textarea-caret-position-mirror-div");o&&o.parentNode.removeChild(o)}var i=document.createElement("div");i.id="input-textarea-caret-position-mirror-div",document.body.appendChild(i);var a=i.style,u=window.getComputedStyle?getComputedStyle(e):e.currentStyle;a.whiteSpace="pre-wrap","INPUT"!==e.nodeName&&(a.wordWrap="break-word"),a.position="absolute",r||(a.visibility="hidden"),l.forEach(function(e){a[e]=u[e]}),f?e.scrollHeight>parseInt(u.height)&&(a.overflowY="scroll"):a.overflow="hidden",i.textContent=e.value.substring(0,t),"INPUT"===e.nodeName&&(i.textContent=i.textContent.replace(/\s/g,"\xc2 "));var s=document.createElement("span");s.textContent=e.value.substring(t)||".",i.appendChild(s);var c={top:s.offsetTop+parseInt(u.borderTopWidth),left:s.offsetLeft+parseInt(u.borderLeftWidth)};return r?s.style.backgroundColor="#aaa":document.body.removeChild(i),c}var l=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"],d="undefined"!=typeof window,f=d&&null!=window.mozInnerScreenX;void 0!==t&&void 0!==t.exports?t.exports=e:d&&(window.getCaretCoordinates=e)}()},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=function(e,t,n){for(var r=e.value,o=t+(n||""),i=document.activeElement,a=0,u=0;r[a]===o[a];)a++;for(;r[r.length-u-1]===o[o.length-u-1];)u++;a=Math.min(a,r.length-u),e.setSelectionRange(a,r.length-u);var s=o.substring(a,o.length-u);return e.focus(),document.execCommand("insertText",!1,s)||(e.value=o),i&&i.focus(),e.setSelectionRange(t.length,t.length),e}}]),window.Thredded=window.Thredded||{},function(){var e="Turbolinks"in window&&window.Turbolinks.supported,t=e&&"clearCache"in window.Turbolinks,n=!1,r=[],o=function(){r.forEach(function(e){e()}),n=!0};window.Thredded.onPageLoad=function(e){r.push(e),!n&&window.Thredded.DOMContentLoadedFired&&e()},t?(window.Turbolinks.controller.lastRenderedLocation&&document.addEventListener("DOMContentLoaded",function(){o()}),document.addEventListener("turbolinks:load",function(){o()})):(window.Thredded.DOMContentLoadedFired||document.addEventListener("DOMContentLoaded",function(){o()}),e&&document.addEventListener("page:load",function(){o()}))}(),window.Thredded.onPageLoad(function(){"Rails"in window?window.Rails.refreshCSRFTokens():"jQuery"in window&&"rails"in window.jQuery&&window.jQuery.rails.refreshCSRFTokens()}),window.Thredded.debounce=function(o,i,a){var u=null;return function(){var e=this,t=arguments,n=function(){u=null,a||o.apply(e,t)},r=a&&!u;clearTimeout(u),u=setTimeout(n,i||200),r&&o.apply(e,t)}},window.Thredded.escapeHtml=function(e){var t=document.createElement("div");return t.textContent=e,t.innerHTML},window.Thredded.hideSoftKeyboard=function(){var e=document.activeElement;e&&e.blur&&e.blur()},window.Thredded.serializeForm=function(e){return Array.prototype.map.call(e.querySelectorAll("[name]"),function(e){return encodeURIComponent(e.name)+"="+encodeURIComponent(e.value)}).join("&")},function(){var e=window.Thredded,t="[data-thredded-currently-online]",n="thredded--is-expanded",r=function(e){e.target.classList.add(n)},o=function(e){e.target.classList.remove(n)},i=function(e){e.target.classList.toggle(n)},a=function(e){e.addEventListener("mouseenter",r),e.addEventListener("mouseleave",o),e.addEventListener("touchstart",i)};e.onPageLoad(function(){Array.prototype.forEach.call(document.querySelectorAll(t),function(e){a(e)})})}(),function(){var e="[data-thredded-flash-message]";document.addEventListener("turbolinks:before-cache",function(){Array.prototype.forEach.call(document.querySelectorAll(e),function(e){e.parentNode.removeChild(e)})})}(),function(){var r=window.Thredded;r.UserTextcomplete={DROPDOWN_CLASS_NAME:"thredded--textcomplete-dropdown",formatUser:function(e){var t=e.avatar_url,n=e.name;return"<div class='thredded--textcomplete-user-result'><img class='thredded--textcomplete-user-result__avatar' src='"+r.escapeHtml(t)+"' ><span class='thredded--textcomplete-user-result__name'>"+r.escapeHtml(n)+"</span></div>"},searchFn:function(e){var o=e.url,i=e.autocompleteMinLength;return function(e,t,n){if(e.length<i)t([]);else{var r=new XMLHttpRequest;r.open("GET",o+"?q="+e,!0),r.setRequestHeader("X-Requested-With","XMLHttpRequest"),r.onload=function(){r.status<200||400<=r.status?t([]):t(JSON.parse(r.responseText).results.map(function(e){return{avatar_url:e.avatar_url,id:e.id,name:e.name,match:n}}))},r.send()}}}},document.addEventListener("turbolinks:before-cache",function(){Array.prototype.forEach.call(document.getElementsByClassName(r.UserTextcomplete.DROPDOWN_CLASS_NAME),function(e){e.parentNode.removeChild(e)})})}();var ThreddedMentionAutocompletion={MATCH_RE:/(^@|\s@)"?([\w.,\- ()]+)$/,DROPDOWN_MAX_COUNT:6,init:function(e,t){var n=new Textcomplete.editors.Textarea(t),r=new Textcomplete(n,{dropdown:{className:Thredded.UserTextcomplete.DROPDOWN_CLASS_NAME,maxCount:ThreddedMentionAutocompletion.DROPDOWN_MAX_COUNT}});r.on("rendered",function(){r.dropdown.items.length&&r.dropdown.items[0].activate()}),r.register([{match:ThreddedMentionAutocompletion.MATCH_RE,search:Thredded.UserTextcomplete.searchFn({url:e.getAttribute("data-autocomplete-url"),autocompleteMinLength:parseInt(e.getAttribute("data-autocomplete-min-length"),10)}),template:Thredded.UserTextcomplete.formatUser,replace:function(e){var t=e.name,n=e.match[1];return/[., ()]/.test(t)?n+'"'+t+'" ':""+n+t+" "}}])}};window.ThreddedMentionAutocompletion=ThreddedMentionAutocompletion;var _createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();!function(){var u="[data-thredded-preview-area]",s="[data-thredded-preview-area-post]",e=function(){function a(e,t){var n=this;_classCallCheck(this,a);var r=e.querySelector(u);if(r&&t){this.form=e,this.preview=r,this.previewPost=e.querySelector(s),this.previewUrl=this.preview.getAttribute("data-thredded-preview-url");var o=null,i=Thredded.debounce(function(){o!==t.value&&(n.updatePreview(),o=t.value)},200,!1);t.addEventListener("input",i,!1),this.requestId=0}}return _createClass(a,[{key:"updatePreview",value:function(){var e=this;this.requestId++;var t=this.requestId,n=new XMLHttpRequest;n.open(this.form.method,this.previewUrl,!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.onload=function(){200<=n.status&&n.status<400&&t===e.requestId&&e.onPreviewResponse(n.responseText)},n.send(Thredded.serializeForm(this.form))}},{key:"onPreviewResponse",value:function(e){this.preview.style.display="block",this.previewPost.innerHTML=e}}]),a}();window.ThreddedPreviewArea=e}(),function(){var e=window.Thredded,n=window.ThreddedMentionAutocompletion,r=window.ThreddedPreviewArea,o=window.autosize,t="[data-thredded-post-form]",i='textarea[name$="[content]"]',a=function(e){var t=e.querySelector(i);o(t),new r(e,t),n.init(e,t)},u=function(e){o.destroy(e.querySelector(i))};e.onPageLoad(function(){Array.prototype.forEach.call(document.querySelectorAll(t),function(e){a(e)})}),document.addEventListener("turbolinks:before-cache",function(){Array.prototype.forEach.call(document.querySelectorAll(t),function(e){u(e)})})}(),function(){function t(e){if(!(0!==e.button||e.ctrlKey||e.altKey||e.metaKey||e.shiftKey)){e.preventDefault();var n=document.getElementById("post_content");n.scrollIntoView(),n.value="...",r(e.target.getAttribute("data-thredded-quote-post"),function(e){if(n.ownerDocument.body.contains(n)){n.focus(),n.value=e;var t=document.createEvent("Event");t.initEvent("autosize:update",!0,!1),n.dispatchEvent(t),n.scrollIntoView()}},function(e){n.value=e})}}function r(e,t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.onload=function(){200<=r.status&&r.status<400?t(r.responseText):n("Error ("+r.status+"): "+r.statusText+" "+r.responseText)},r.onerror=function(){n("Network Error")},r.send()}window.Thredded.onPageLoad(function(){Array.prototype.forEach.call(document.querySelectorAll("[data-thredded-quote-post]"),function(e){e.addEventListener("click",t)})})}(),function(){var t,n,r="#thredded--container [data-time-ago]",e=window.Thredded;"timeago"in window?(n=window.timeago,e.onPageLoad(function(){var e=document.querySelector("#thredded--container");e&&n().render(document.querySelectorAll(r),e.getAttribute("data-thredded-locale"))}),document.addEventListener("turbolinks:before-cache",function(){n.cancel()})):"jQuery"in window&&"timeago"in jQuery.fn&&(t=window.jQuery,e.onPageLoad(function(){var e=t.timeago.settings.allowFuture;t.timeago.settings.allowFuture=!0,t(r).timeago(),t.timeago.settings.allowFuture=e}))}(),function(){var e=window.Thredded,t=window.ThreddedMentionAutocompletion,i=window.ThreddedPreviewArea,a=window.autosize,n="[data-thredded-topic-form]",u='[name$="topic[title]"]',s='textarea[name$="[content]"]',c="thredded--is-compact",r="thredded--is-expanded",l=27,o=function(n){var r=n.querySelector(s);if(a(r),new i(n,r),t.init(n,r),n.classList.contains(c)){var o=n.querySelector(u);o.addEventListener("focus",function(){d(n,!0)}),[o,r].forEach(function(e){e.addEventListener("keydown",function(e){e.keyCode===l&&(e.target.blur(),d(n,!1))}),e.addEventListener("blur",function(){var t=function e(t){n.contains(t.target)||o.value||r.value||d(n,!1),document.body.removeEventListener("touchend",e),document.body.removeEventListener("mouseup",e)};document.body.addEventListener("mouseup",t),document.body.addEventListener("touchend",t)})})}},d=function(e,t){t?(e.classList.remove(c),e.classList.add(r)):(e.classList.remove(r),e.classList.add(c))},f=function(e){a.destroy(e.querySelector(s))};e.onPageLoad(function(){Array.prototype.forEach.call(document.querySelectorAll(n),function(e){o(e)})}),document.addEventListener("turbolinks:before-cache",function(){Array.prototype.forEach.call(document.querySelectorAll(n),function(e){f(e)})})}(),function(){function r(e){var t=e.match(/\/page-(\d)$/);return t?+t[1]:1}function o(e){return Math.ceil(e/c)}function i(e){for(;(e=e.parentNode)&&"ARTICLE"!==e.tagName;);return e}function e(e){e.addEventListener("click",function(e){var t=e.target;if("A"===t.tagName&&"H1"===t.parentNode.tagName){var n=i(t);r(t.href)===o(+n.querySelector(s).textContent)&&(n.classList.add(u),n.classList.remove(a))}})}var t=window.Thredded,n="[data-thredded-topics]",a="thredded--topic-unread",u="thredded--topic-read",s=".thredded--topics--posts-count",c=50;t.onPageLoad(function(){Array.prototype.forEach.call(document.querySelectorAll(n),e)})}(),function(){var n=window.Thredded,r=window.Turbolinks;n.onPageLoad(function(){r&&r.supported&&Array.prototype.forEach.call(document.querySelectorAll("[data-thredded-turboform]"),function(e){e.addEventListener("submit",t)})});var t=function(e){e.preventDefault();var t=e.currentTarget;r.visit(t.action+(-1===t.action.indexOf("?")?"?":"&")+n.serializeForm(t)),n.hideSoftKeyboard()}}();_createClass=function(){function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}}();!function(){var t=window.Thredded,n="[data-thredded-user-preferences-form]",r="data-thredded-bound-messageboard-pref",o="data-thredded-update-checkbox-on-change",i=function(){function o(e,t,n){var r=this;_classCallCheck(this,o),this.messageboardCheckbox=e.querySelector('[type="checkbox"][name="'+n+'"]'),this.messageboardCheckbox&&(this.messageboardCheckbox.addEventListener("change",function(){r.rememberMessageboardChecked()}),this.rememberMessageboardChecked(),this.genericCheckbox=e.querySelector('[type="checkbox"][name="'+t+'"]'),this.genericCheckbox.addEventListener("change",function(){r.updateMessageboardCheckbox()}),this.updateMessageboardCheckbox())}return _createClass(o,[{key:"rememberMessageboardChecked",value:function(){this.messageboardCheckedWas=this.messageboardCheckbox.checked}},{key:"updateMessageboardCheckbox",value:function(){var e=this.genericCheckbox.checked;this.messageboardCheckbox.disabled=!e,this.messageboardCheckbox.checked=!!e&&this.messageboardCheckedWas}}]),o}(),a=function e(t,n,r){_classCallCheck(this,e);var o=t.querySelector('[type="checkbox"][name="'+r+'"]');o&&n.addEventListener("change",function(){o.checked=n.checked})},u=function e(t){_classCallCheck(this,e),Array.prototype.forEach.call(t.querySelectorAll("input["+r+"]"),function(e){new i(t,e.name,e.getAttribute(r))}),Array.prototype.forEach.call(t.querySelectorAll("input["+o+"]"),function(e){new a(t,e,e.getAttribute(o))})};t.onPageLoad(function(){Array.prototype.forEach.call(document.querySelectorAll(n),function(e){new u(e)})})}(),function(){function a(e){for(var t=[],n=[],r=0,o=!1,i=!1,a=0;a<e.length;++a){var u=e.charAt(a);switch(u){case'"':o=!o;break;case" ":i&&n.push(u);break;case",":o?n.push(u):(i=!1,n.length&&(t.push({name:n.join(""),index:r}),n.length=0));break;default:i||(r=a),i=!0,n.push(u)}}return n.length&&t.push({name:n.join(""),index:r}),t}function t(e){i.destroy(e)}var n=window.Thredded,i=window.autosize,e="[data-thredded-users-select]";n.UsersSelect={DROPDOWN_MAX_COUNT:6};var r=function(r){i(r),r.addEventListener("keypress",function(e){13!==e.keyCode&&10!==e.keyCode||e.preventDefault()});var e=new Textcomplete.editors.Textarea(r),t=new Textcomplete(e,{dropdown:{className:n.UserTextcomplete.DROPDOWN_CLASS_NAME,maxCount:n.UsersSelect.DROPDOWN_MAX_COUNT}}),o=n.UserTextcomplete.searchFn({url:r.getAttribute("data-autocomplete-url"),autocompleteMinLength:parseInt(r.getAttribute("data-autocomplete-min-length"),10)});t.on("rendered",function(){t.dropdown.items.length&&t.dropdown.items[0].activate()}),t.register([{index:0,match:function(e){var t=a(e);if(t.length){var n=t[t.length-1],r=n.name,o=n.index,i=[r];return i.index=o,i}return null},search:function(e,n,t){o(e,function(e){var t=a(r.value).map(function(e){return e.name});n(e.filter(function(e){return-1===t.indexOf(e.name)}))},t)},template:n.UserTextcomplete.formatUser,replace:function(e){var t=e.name;return/,/.test(t)?'"'+t+'", ':t+", "}}])};window.Thredded.onPageLoad(function(){Array.prototype.forEach.call(document.querySelectorAll(e),function(e){r(e)})}),document.addEventListener("turbolinks:before-cache",function(){Array.prototype.forEach.call(document.querySelectorAll(e),function(e){t(e)})})}();